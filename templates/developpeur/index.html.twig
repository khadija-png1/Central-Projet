{% extends 'base_dashboard.html.twig' %}

{% block title %}Développeurs {% endblock %}


{% block stylesheets %}
 <style>
   .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
        h2{
            color:#777977;
            margin-left:20%;
        
        }
        .modal-content {
            background-color: #f2f2f2; /* Ou la couleur que tu veux, ex: #dddddd, #fafafa, etc. */
            color: #333; /* facultatif : couleur du texte */
        }
        .modal-header, .modal-body, .modal-footer {
            background-color: transparent; /* ou un autre si tu veux des parties différentes */
        }
        .btn.btn-icon {
            width: 30px;
            height: 30px;
            margin-right: 7px;
        }
        .btn.btn-social-icon {
            width: 40px;
            height: 40px;
            margin-right: 50px;
        }
        .footer{
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #333;
            color: #fff;
            text-align: center;
            padding: 10px 0;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
        }
     
    </style>
{% endblock %}

{% block body %}
<div class="content-wrapper">
    <div class="row">
        <div class="col-lg-12 grid-margin grid-margin-lg-0 stretch-card">
            <div class="card">
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-8">
                                {% include 'search/search.html.twig' with { 'form': form } %}
                        </div>
                        
                        <div class="col-md-4 d-flex align-items-center justify-content-end">
                            <div>
                                <button class="btn btn-sm btn-info new d-inline-flex align-items-center gap-2 px-3 py-2 shadow-sm rounded-2" type="button">
                                    <i class="bi bi-plus-lg fs-5 d-flex align-items-center"></i>
                                    <span class="fw-semibold">Nouveau</span>
                                </button>
                            </div>
                        </div>
                    </div>
                             <!-- Tableau Global (Visible par défaut) -->
                    <div id="global-table-container" class="table-responsive">
                        {% include 'developpeur/_search_result.html.twig' with { 'developpeurs': developpeurs } %}
                    </div>

                            <!-- Résultats de la recherche (Cachés par défaut) -->
                    <div id="search-results" style="display: none;"></div>

                            <!-- Spinner de chargement -->
                    <div id="loading-spinner" class="text-center my-4" style="display: none;"> 
                        <div class="spinner-border text-info" role="status">
                            <span class="visually-hidden">Chargement...</span>
                        </div>
                    </div>  
                </div>
            </div>
        </div>
    </div>
</div>

</div>
<!-- Modal pop_up-->
<div class="modal fade" id="developerModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-md" role="document">

    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
       <h1 class="modal-title text-info w-100 text-center mb-4" id="name" style="display: none;"></h1>                  

      <div class="modal-body">
        
      </div>

    </div>
  </div>
</div>

<!-- modal de show  -->
<div class="modal" tabindex="-1" id="show" >
  <div class="modal-dialog modal-lg"> {# Exemple avec modal-lg #}
    <div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title text-info w-100 text-center mb-4" id="showModalTitle"></h5>
    </div>

      <div class="modal-body">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal">Fermer</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>

//--------SCRIPT ADD  DEVELOPPEUR---------

$(document).on('click', '.new', function () {
                $('#name').hide();

    $.ajax({
        type: "GET",
        url: "/developpeur/new",
        cache: false,
        success: function (data) {
            // Injecter la réponse dans la modal
            $('#developerModal .modal-body').html(data);
            // Afficher la modal
            $('#developerModal').modal('show');
        },
        error: function (e) {
            console.error("Erreur lors du chargement :", e);
        }
    });
});
//--------SCRIPT  UPDATE DEVELOPPEUR---------
$(document).on('click', '.update', function () {
       let id = $(this).data('id');
            let nom = $(this).data('nom');
            console.log("ID récupéré :", id); // <-- pour voir si c'est vide
            console.log("Nom récupéré :", nom);
    if (!id) {
        console.error("Aucun ID n’a été trouvé dans data-id !");
        return;
    }

    $.ajax({
        type: "GET",
        url: "/developpeur/update/" +id ,
        cache: false,
        success: function (data) {
            // Injecter la réponse dans la modal
            $('#developerModal .modal-body').html(data);
            // Afficher la modal
            $('#developerModal').modal('show');
        },
        error: function (e) {
            console.error("Erreur lors du chargement :", e);
        }
    });
});
//--------SCRIPT DELETE  DEVELOPPEUR---------
$(document).on('click', '.delete', function () {
    let id = $(this).data('id');
    console.log("ID récupéré :", id); // <-- pour voir si c'est vide
    if (!id) {
        console.error("Aucun ID n’a été trouvé dans data-id !");
        return;
    }
    $.ajax({
        type: "GET",
        url: "/developpeur/delete/"+id,
        cache: false,
        success: function (data) {
            // Injecter la réponse dans la modal
            $('#developerModal .modal-body').html(data);
            // Afficher la modal
            $('#developerModal').modal('show');
        },
        error: function (e) {
            console.error("Erreur lors du chargement :", e);
        }
    });
});

   //--------SCRIPT DELETE  DEVELOPPEUR---------
        $(document).on('click', '.show', function () {
                let id = $(this).data('id');
                let nom = $(this).data('nom');

                console.log("ID récupéré :", id); // <-- pour voir si c'est vide
                console.log("Nom récupéré :", nom);

            if (!id) {
                console.error("Aucun ID n’a été trouvé dans data-id !");
                return;
            }
                $('#showModalTitle').text(nom);

            $.ajax({
                type: "GET",
                url: "/developpeur/show/"+id,
                cache: false,
                success: function (data) {
                    // Injecter la réponse dans la modal
                    $('#show .modal-body').html(data);
                    // Afficher la modal
                    $('#show').modal('show');
                },
                error: function (e) {
                    console.error("Erreur lors du chargement :", e);
                }
            });
        });

</script>

{% endblock %}